update_one() {
    echo updating $(basename $PWD)
    if [ -d .hg ]
    then
        hg pull -u
    elif [ -d .git ]
    then
        git pull
    fi
}

update() {
    if [ -d .hg -o -d .git ]
    then
        update_one
    else
        for dir in */
        do
            (cd $dir && update_one) || break
        done
    fi
}
